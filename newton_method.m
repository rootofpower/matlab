function [root, iterations, all_x] = newton_method(f, df, x0, tol, max_iter)
% NEWTON_METHOD Знаходження кореня рівняння методом Ньютона (метод дотичних)
%
% Опис методу:
% Метод Ньютона (метод дотичних або метод Ньютона-Рафсона) - це ітераційний метод
% пошуку коренів, який використовує лінійну апроксимацію функції в поточній точці
% через дотичну до графіка. Метод має квадратичну збіжність, що робить його
% дуже ефективним, особливо коли початкове наближення близьке до кореня.
%
% Вхідні параметри:
%   f        - функція, корінь якої шукаємо
%   df       - похідна функції f
%   x0       - початкове наближення
%   tol      - допустима похибка
%   max_iter - максимальна кількість ітерацій
%
% Вихідні параметри:
%   root        - знайдений корінь
%   iterations  - кількість ітерацій
%   all_x       - усі наближення, отримані в процесі роботи методу

% Ініціалізація
iterations = 0;
all_x = x0;
x = x0;

% Основний цикл
while iterations < max_iter
    % Обчислення значення функції та її похідної
    f_x = f(x);
    df_x = df(x);
    
    % Перевірка на ділення на нуль
    if abs(df_x) < eps
        warning('Похідна близька до нуля. Метод може розбігатися.');
        break;
    end
    
    % Формула методу Ньютона
    x_new = x - f_x / df_x;
    all_x = [all_x; x_new];
    
    % Перевірка точності
    if abs(x_new - x) < tol || abs(f(x_new)) < tol
        root = x_new;
        iterations = iterations + 1;
        return;
    end
    
    % Підготовка до наступної ітерації
    x = x_new;
    iterations = iterations + 1;
end

% Якщо досягнуто максимальної кількості ітерацій
root = x;
end

% Приклад використання:
% f = @(x) x^3 - x - 2;  % Функція f(x) = x^3 - x - 2
% df = @(x) 3*x^2 - 1;   % Похідна функції f(x)
% [root, iter, all_x] = newton_method(f, df, 1.5, 1e-6, 100);
% disp(['Корінь: ', num2str(root)]);
% disp(['Кількість ітерацій: ', num2str(iter)]); 