function [y_interp, L] = lagrange_interpolation(x, y, x_interp)
    % LAGRANGE_INTERPOLATION Обчислює значення інтерполяційного поліному Лагранжа
    % 
    % Вхідні параметри:
    % x - масив x-координат вузлів інтерполяції
    % y - масив y-координат вузлів інтерполяції
    % x_interp - масив точок, в яких потрібно обчислити значення поліному
    %
    % Вихідні параметри:
    % y_interp - масив значень поліному в точках x_interp
    % L - коефіцієнти поліному Лагранжа (опціонально)
    
    % Перевірка вхідних даних
    if length(x) ~= length(y)
        error('Масиви x та y повинні мати однакову довжину');
    end
    
    n = length(x);
    m = length(x_interp);
    
    % Ініціалізація коефіцієнтів поліному
    L = zeros(1, n);
    
    % Обчислення коефіцієнтів поліному Лагранжа
    for i = 1:n
        up = 1;
        down = 1;
        
        for j = 1:n
            if i ~= j
                down = down * (x(i) - x(j));
                p = [1 (-1 * x(j))];
                up = conv(up, p);
            end
        end
        
        % Додаємо внесок поточного вузла до загального поліному
        L = L + ((up / down) * y(i));
    end
    
    % Обчислення значень поліному в точках x_interp
    y_interp = polyval(L, x_interp);
end 