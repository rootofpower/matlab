function [x, iterations, all_x] = jacobi_method(A, b, x0, tol, max_iter)
% JACOBI_METHOD Розв'язання системи лінійних рівнянь методом Якобі
%
% Опис методу:
% Метод Якобі (метод простої ітерації для СЛАР) - це ітераційний метод для
% розв'язання системи лінійних алгебраїчних рівнянь Ax = b. 
% Система перетворюється до вигляду x = Bx + c, де B = -D^(-1)(L + U),
% c = D^(-1)b, а D, L, U - діагональна, нижня та верхня трикутні матриці.
% Метод збігається, якщо спектральний радіус матриці B менший за 1.
%
% Вхідні параметри:
%   A        - матриця коефіцієнтів СЛАР
%   b        - вектор правих частин
%   x0       - початкове наближення
%   tol      - допустима похибка
%   max_iter - максимальна кількість ітерацій
%
% Вихідні параметри:
%   x           - розв'язок СЛАР
%   iterations  - кількість ітерацій
%   all_x       - усі наближення, отримані в процесі роботи методу

% Перевірка розмірностей
[n, m] = size(A);
if n ~= m
    error('Матриця A повинна бути квадратною');
end

if length(b) ~= n
    error('Розмірність вектора b повинна відповідати розмірності матриці A');
end

if nargin < 3 || isempty(x0)
    x0 = zeros(n, 1);
end

% Ініціалізація
iterations = 0;
x = x0;
all_x = x0;

% Виділення діагональних елементів
D = diag(diag(A));
R = A - D;

% Перевірка на нульові діагональні елементи
if any(diag(A) == 0)
    error('Метод Якобі вимагає ненульових діагональних елементів');
end

% Обчислення оберненої діагональної матриці
D_inv = diag(1./diag(A));

% Основний цикл
while iterations < max_iter
    % Обчислення наступного наближення
    x_new = D_inv * (b - R * x);
    all_x = [all_x, x_new];
    
    % Перевірка точності
    if norm(x_new - x) < tol
        x = x_new;
        iterations = iterations + 1;
        return;
    end
    
    % Підготовка до наступної ітерації
    x = x_new;
    iterations = iterations + 1;
end

% Якщо досягнуто максимальної кількості ітерацій
warning('Досягнуто максимальної кількості ітерацій. Метод може розбігатися.');
end

% Приклад використання:
% A = [10, -1, 2; -1, 11, -1; 2, -1, 10];
% b = [6; 25; -11];
% x0 = zeros(3, 1);
% [x, iter, all_x] = jacobi_method(A, b, x0, 1e-6, 100);
% disp('Розв''язок СЛАР:');
% disp(x);
% disp(['Кількість ітерацій: ', num2str(iter)]); 